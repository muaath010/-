<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Na'awn Delivery Services</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary-gold: #D4AF37;
            --dark-gold: #AA8C2C;
            --bg-white: #FFFFFF;
            --text-dark: #333333;
            --light-gray: #F9F9F9;
        }
        body {
            font-family: 'Cairo', sans-serif; margin: 0; padding: 0;
            background-color: var(--light-gray); color: var(--text-dark);
        }
        .header {
            background-color: var(--bg-white); color: var(--primary-gold);
            text-align: center; padding: 15px; font-size: 24px; font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-bottom: 3px solid var(--primary-gold);
            position: sticky; top: 0; z-index: 1000;
        }
        .container { padding: 20px; max-width: 600px; margin: 0 auto; }
        .card {
            background: var(--bg-white); border-radius: 12px; padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); margin-bottom: 20px;
        }
        input, select, textarea, button {
            width: 100%; padding: 12px; margin: 10px 0;
            border-radius: 8px; border: 1px solid #ddd;
            font-family: 'Cairo', sans-serif; box-sizing: border-box;
        }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary-gold); }
        button {
            background-color: var(--primary-gold); color: var(--bg-white);
            border: none; font-size: 16px; font-weight: bold;
            cursor: pointer; transition: 0.3s;
        }
        button:hover { background-color: var(--dark-gold); }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .hidden { display: none; }
        .nav-buttons { display: flex; gap: 10px; margin-bottom: 20px; }
        #map { height: 350px; border-radius: 8px; margin-top: 15px; z-index: 1;}
        .section-title { color: var(--primary-gold); border-bottom: 2px solid #eee; padding-bottom: 5px; }
        .badge { background: #eee; padding: 3px 8px; border-radius: 5px; font-size: 12px; }
        .badge.green { background: #d4edda; color: #155724; }
        .badge.gold { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>

    <div class="header">Na'awn Delivery</div>

    <div class="container">
        <div class="nav-buttons" id="main-nav">
            <button onclick="showSection('customer-login')">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
            <button onclick="showSection('driver-login')">Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</button>
            <button onclick="showSection('admin-login')">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
        </div>

        <div id="customer-login" class="card section">
            <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
            <input type="tel" id="cust-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ù…Ø«Ø§Ù„: 9XXXXXXX)">
            <button onclick="loginCustomer()">Ø¯Ø®ÙˆÙ„ Ù„Ø·Ù„Ø¨ ØªÙˆØµÙŠÙ„</button>
        </div>

        <div id="customer-dashboard" class="card section hidden">
            <h3>Ø·Ù„Ø¨ ØªÙˆØµÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
            <input type="text" id="cust-city" placeholder="Ø§Ù„ÙˆÙ„Ø§ÙŠØ© (Ù…Ø«Ø§Ù„: Ø¹Ø¨Ø±ÙŠØŒ Ù†Ø²ÙˆÙ‰)">
            <input type="text" id="cust-area" placeholder="Ø§Ù„Ù…Ù†Ø·Ù‚Ø© / Ø§Ù„Ø­ÙŠ (Ù…Ø«Ø§Ù„: Ø§Ù„Ø³ÙˆÙ‚ØŒ Ø§Ù„Ø±ÙŠØ¨Ø©)">
            <input type="text" id="pickup-loc" placeholder="Ù…ÙƒØ§Ù† Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„/Ø§Ù„Ù…Ø·Ø¹Ù…)">
            <textarea id="order-details" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨..."></textarea>
            
            <button onclick="submitOrder(event)">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ğŸ“²</button>
        </div>

        <div id="driver-login" class="card section hidden">
            <h3>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</h3>
            <input type="text" id="drv-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ…">
            <input type="text" id="drv-id" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©">
            <input type="password" id="drv-pass" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ">
            <button onclick="loginDriver()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        </div>

        <div id="driver-dashboard" class="card section hidden">
            <h3>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ù†Ø¯Ø© Ø¥Ù„ÙŠÙƒ</h3>
            <button onclick="fetchDriverOrders()">ØªØ­Ø¯ÙŠØ« Ø·Ù„Ø¨Ø§ØªÙŠ ğŸ”„</button>
            <div id="driver-orders-list"></div>
            <div id="map-container" class="hidden">
                <h4 class="section-title">ğŸ“ ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h4>
                <div id="map"></div>
            </div>
        </div>

        <div id="admin-login" class="card section hidden">
            <h3>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
            <input type="text" id="adm-user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            <input type="password" id="adm-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <button onclick="loginAdmin()">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
        </div>

        <div id="admin-dashboard" class="card section hidden">
            <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</h3>
            <button id="refresh-btn" onclick="fetchAdminData()">ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ğŸ”„</button>
            
            <h4 class="section-title" style="margin-top: 20px;">ğŸ†• Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¥Ø³Ù†Ø§Ø¯)</h4>
            <div id="admin-new-orders"></div>

            <h4 class="section-title" style="margin-top: 30px;">ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ­Ø§Ù„ØªÙ‡Ø§</h4>
            <div id="admin-all-orders"></div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Ø±Ø§Ø¨Ø· Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzJtGBOwTRAM0SrHOi09L97MFYj2QS-RoZL8p9GCSPhpcI-ojl54Fd7axb3KY2-e70w/exec';
        const ADMIN_PHONE = "93516953";

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(el => el.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
        }

        /* ================= Ø§Ù„Ø¹Ù…ÙŠÙ„ ================= */
        function loginCustomer() {
            const phone = document.getElementById('cust-phone').value;
            if(phone.length >= 8) {
                localStorage.setItem('customerPhone', phone);
                showSection('customer-dashboard');
            } else { alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­'); }
        }

        function submitOrder(event) {
            const payload = {
                action: 'new_order',
                phone: localStorage.getItem('customerPhone'),
                city: document.getElementById('cust-city').value,
                area: document.getElementById('cust-area').value,
                pickup: document.getElementById('pickup-loc').value,
                details: document.getElementById('order-details').value
            };

            if(!payload.city || !payload.area || !payload.pickup || !payload.details) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨'); return;
            }

            const btn = event.target;
            btn.innerText = 'Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨... â³';
            btn.disabled = true;

            fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) })
            .then(response => response.json())
            .then(data => {
                // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©
                let msg = `âœ¨ Ø£Ù‡Ù„Ø§Ù‹ Ø¥Ø¯Ø§Ø±Ø© ÙØ±ÙŠÙ‚ Ù†Ø¹Ø§ÙˆÙ†!\nÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨ ØªÙˆØµÙŠÙ„ Ø¬Ø¯ÙŠØ¯ Ù„Ù„ØªÙˆ Ø¹Ø¨Ø± Ø§Ù„Ù…Ù†ØµØ©.\n\nğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${payload.city} - ${payload.area}\nğŸª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù†: ${payload.pickup}\nğŸ“¦ Ø§Ù„ØªÙØ§ØµÙŠÙ„: ${payload.details}\nğŸ“ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${payload.phone}\n\nØ±Ø¬Ø§Ø¡Ù‹ Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ø·Ù„Ø¨.`;
                window.open(`https://wa.me/968${ADMIN_PHONE}?text=${encodeURIComponent(msg)}`, '_blank');
                
                alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­!');
                document.getElementById('pickup-loc').value = '';
                document.getElementById('order-details').value = '';
            }).finally(() => {
                btn.innerText = 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ğŸ“²';
                btn.disabled = false;
            });
        }

        /* ================= Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ ================= */
        let map, marker;
        function loginDriver() {
            const name = document.getElementById('drv-name').value;
            const id = document.getElementById('drv-id').value;
            if(name && id) {
                localStorage.setItem('driverName', name);
                localStorage.setItem('driverId', id);
                showSection('driver-dashboard');
                fetchDriverOrders();
            } else { alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©'); }
        }

        function fetchDriverOrders() {
            const id = localStorage.getItem('driverId');
            const container = document.getElementById('driver-orders-list');
            container.innerHTML = '<p>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø·Ù„Ø¨Ø§ØªÙƒ...</p>';

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'get_driver_data', driverId: id })
            })
            .then(res => res.json())
            .then(data => {
                container.innerHTML = '';
                if(data.orders.length === 0) {
                    container.innerHTML = '<p style="color:green;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø³Ù†Ø¯Ø© Ø¥Ù„ÙŠÙƒ Ø­Ø§Ù„ÙŠØ§Ù‹.</p>';
                    return;
                }

                data.orders.forEach(order => {
                    container.innerHTML += `
                        <div style="border:1px solid #ddd; padding:15px; border-radius:8px; margin-bottom:15px;">
                            <h4 style="margin-top:0;">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${order.id}</h4>
                            <p><strong>Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù†:</strong> ${order.pickup}</p>
                            <p><strong>Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø¥Ù„Ù‰:</strong> ${order.city} - ${order.area}</p>
                            <p><strong>Ø§Ù„ØªÙØ§ØµÙŠÙ„:</strong> ${order.details}</p>
                            <button onclick="acceptOrder('${order.id}')" style="background:#28a745; margin-top:10px;">Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¨Ø¯Ø¡ Ø§Ù„ØªØªØ¨Ø¹ ğŸ“</button>
                        </div>
                    `;
                });
            });
        }

        function acceptOrder(orderId) {
            const dName = localStorage.getItem('driverName');
            const dId = localStorage.getItem('driverId');

            // Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
            let msg = `ğŸš€ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©!\nØ£Ù†Ø§ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨: ${dName} (Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©: ${dId})\n\nÙ„Ù‚Ø¯ Ù‚Ù…Øª Ø¨ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø±Ù‚Ù… [ ${orderId} ] Ù…Ù† Ø§Ù„Ù…Ù†ØµØ©ØŒ ÙˆØ£Ù†Ø§ ÙÙŠ Ø·Ø±ÙŠÙ‚ÙŠ Ø§Ù„Ø¢Ù† Ù„Ø¥Ù†Ø¬Ø§Ø²Ù‡! ğŸ“`;
            window.open(`https://wa.me/968${ADMIN_PHONE}?text=${encodeURIComponent(msg)}`, '_blank');

            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
            document.getElementById('map-container').classList.remove('hidden');
            if(!map) {
                map = L.map('map').setView([23.2255, 56.5165], 14);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            }
            
            if ("geolocation" in navigator) {
                navigator.geolocation.watchPosition(position => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    if(!marker) { marker = L.marker([lat, lng]).addTo(map); } 
                    else { marker.setLatLng([lat, lng]); }
                    map.panTo([lat, lng]);
                }, error => alert("ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù€ GPS Ø¨Ø§Ù„Ù‡Ø§ØªÙ Ù„ÙŠØ¹Ù…Ù„ Ø§Ù„ØªØªØ¨Ø¹"), {enableHighAccuracy: true});
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ø´ÙŠØª
            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'update_status', orderId: orderId, newStatus: 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„ (Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚)' })
            });
        }

        /* ================= Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ================= */
        function loginAdmin() { showSection('admin-dashboard'); fetchAdminData(); }

        function fetchAdminData() {
            const btn = document.getElementById('refresh-btn');
            btn.innerText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«... â³'; btn.disabled = true;
            
            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'get_admin_data' })
            })
            .then(res => res.json())
            .then(data => {
                renderAdminDashboard(data.newOrders, data.allOrders, data.drivers);
            }).finally(() => { btn.innerText = 'ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ğŸ”„'; btn.disabled = false; });
        }

        function renderAdminDashboard(newOrders, allOrders, drivers) {
            const newContainer = document.getElementById('admin-new-orders');
            const allContainer = document.getElementById('admin-all-orders');
            newContainer.innerHTML = ''; allContainer.innerHTML = '';

            // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            if(newOrders.length === 0) {
                newContainer.innerHTML = '<p style="color:#888;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.</p>';
            } else {
                let driversOptions = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨...</option>';
                drivers.forEach(d => {
                    driversOptions += `<option value="${d.id}" data-name="${d.name}">${d.name} (${d.load} Ø·Ù„Ø¨Ø§Øª Ù†Ø´Ø·Ø©)</option>`;
                });

                newOrders.forEach(order => {
                    newContainer.innerHTML += `
                        <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-right: 5px solid var(--primary-gold);">
                            <h4 style="margin:0;">Ø·Ù„Ø¨: ${order.id}</h4>
                            <p><strong>Ù…Ù†:</strong> ${order.pickup} | <strong>Ø¥Ù„Ù‰:</strong> ${order.area}</p>
                            <select id="driver-select-${order.id}" style="margin-bottom:10px;">${driversOptions}</select>
                            <button onclick="assignOrder('${order.id}', '${order.phone}', event)" style="background:var(--primary-gold);">Ø¥Ø³Ù†Ø§Ø¯ ÙˆØ¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¹Ù…ÙŠÙ„ ğŸ“²</button>
                        </div>
                    `;
                });
            }

            // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ù…Ø¹Ø±ÙØ© Ø£ÙŠÙ† Ù‡ÙŠ ÙˆÙ…Ø¹ Ù…Ù†
            allOrders.reverse().forEach(order => {
                let statusClass = order.status.includes('Ø§Ù†ØªØ¸Ø§Ø±') ? 'gold' : 'green';
                let driverInfo = order.driverName ? ` (Ù…Ø¹ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨: ${order.driverName})` : '';
                allContainer.innerHTML += `
                    <div style="border-bottom: 1px solid #eee; padding: 10px 0;">
                        <div style="display:flex; justify-content:space-between;">
                            <strong>${order.id}</strong>
                            <span class="badge ${statusClass}">${order.status}</span>
                        </div>
                        <p style="margin:5px 0; font-size:14px; color:#555;">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${order.area} ${driverInfo}</p>
                    </div>
                `;
            });
        }

        function assignOrder(orderId, customerPhone, event) {
            const select = document.getElementById(`driver-select-${orderId}`);
            const driverId = select.value;
            if(!driverId) { alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†Ø¯ÙˆØ¨!'); return; }

            const driverName = select.options[select.selectedIndex].getAttribute('data-name');
            event.target.innerText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø³Ù†Ø§Ø¯...';

            // Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
            let msg = `ğŸŒŸ Ø¹Ù…ÙŠÙ„Ù†Ø§ Ø§Ù„Ø¹Ø²ÙŠØ²ØŒ\nØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ (Ø±Ù‚Ù… ${orderId}) Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© ÙØ±ÙŠÙ‚ Ù†Ø¹Ø§ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­!\n\nğŸ›µ ØªÙ… Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨: ${driverName}.\nØ§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ÙÙŠ Ø·Ø±ÙŠÙ‚Ù‡ Ù„Ù„Ø¨Ø¯Ø¡ ÙˆØ§Ù„ØªÙˆØµÙŠÙ„.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ø®Ø¯Ù…Ø§Øª Ù†Ø¹Ø§ÙˆÙ† Ù„Ù„ØªÙˆØµÙŠÙ„! âœ¨`;
            window.open(`https://wa.me/968${customerPhone}?text=${encodeURIComponent(msg)}`, '_blank');

            // Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø´ÙŠØª
            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'update_status', orderId: orderId, newStatus: 'ØªÙ… Ø§Ù„Ø¥Ø³Ù†Ø§Ø¯ Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨', driverId: driverId, driverName: driverName })
            }).then(() => fetchAdminData());
        }
    </script>
</body>
</html>
